\usepackage[T1]{fontenc}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{xspace}
\usepackage{mathtools}
\let\proof\relax\let\endproof\relax
\usepackage{amsthm}
\usepackage{mathtools}
\usepackage[operators,sets]{cryptocode}
\usepackage{caption}
\usepackage{color}
\usepackage{bm}
\usepackage{xcolor}
\usepackage{xurl}
\usepackage{algorithm}
\usepackage[noend]{algpseudocode}
\usepackage{array}
\usepackage{algpseudocodex}
\usepackage{multicol}
\usepackage{tabularx}
\usepackage{float}
\usepackage{xspace}
\usepackage{varwidth}
\usepackage{fancyvrb}
\usepackage{pgfplots}
\usepackage{todonotes}
\usepackage{subcaption}
\usepackage{booktabs}
\usepackage{graphicx}

\pgfplotsset{width=7cm,compat=1.18}\usepgfplotslibrary{statistics}
\usetikzlibrary{patterns}
\setlength{\marginparwidth}{2cm}
\definecolor{bar2colour}{rgb}{1,0.7,0.7}

\newcommand{\game}{\textbf{Game}\xspace}
\newcommand{\oracle}{\textbf{Oracle}\xspace}
\newcommand{\algor}{\textbf{Algorithm}\xspace}
\newcommand{\pset}[1]{\mathbf{#1}}
\newcommand{\assign}{\leftarrow}
\newcommand{\foutput}{\rightarrow}
\newcommand{\size}[1]{\lvert #1 \rvert}
\newcommand{\rsample}{\rotatebox[origin=c]{-180}{$\hspace{0.1cm}\sample\hspace{0.1cm}$}}
\newcommand{\bits}{\{0,1\}}
\newcommand{\sk}{sk}
\newcommand{\pk}{pk}
\newcommand{\NIKE}{\text{X25519}\xspace}
\newcommand{\kem}{\text{KEM}\xspace}
\newcommand{\KEM}{\text{ML-KEM-768}\xspace}
\newcommand{\XWing}{\text{X-Wing}\xspace}
\newcommand{\PKE}{\text{PKE}\xspace}
\newcommand{\state}{st}
\newcommand{\adversary}[1]{\mathcal{#1}}
\newcommand{\keygen}{\textsf{KeyGen}\xspace}
\newcommand{\random}{\textsf{random}\xspace}
\newcommand{\dec}{\textsf{Dec}\xspace}
\newcommand{\enc}{\textsf{Enc}\xspace}
\newcommand{\DiffieHellman}{\textsf{DH}\xspace}
\newcommand{\Eval}{\textsf{Eval}\xspace}
\newcommand{\compare}{=}
\newcommand{\ifthen}[1]{\textbf{if } #1 \textbf{ then}}
\newcommand{\elsedo}[1]{\textbf{else } #1}
\newcommand{\abort}{abort\xspace}
\newcommand{\ROMtable}{\sum}
\newcommand{\advantage}[2]{\text{Adv}_{#1}^{#2}}
\newcommand{\prone}[1]{\Pr[#1 \Rightarrow 1]}
\newcommand{\pr}[1]{\textrm{\textup{Pr}}\left[ {#1} \right]}
\newcommand{\cca}{\text{IND-CCA}\xspace}
\newcommand{\sdh}{\text{SDH}\xspace}
\newcommand{\kemcoll}{\text{C2PRI}\xspace}
\newcommand{\hashqueries}{q_h}
\newcommand{\oraclequeries}{q_d}
\newcommand{\gamedifference}[2]{| \prone{G^{\adversary{A}}_{#1}} - \prone{G^{\adversary{A}}_{#2}} |}
\newcommand{\qsf}{\text{QSF}\xspace}
\newcommand{\hashinput}{\text{label} \concat k_1 \concat k_2 \concat c_2 \concat \pk_2}
\newcommand{\hashinputxwing}{\texttt{``\textbackslash .//\textasciicircum\textbackslash''} \concat k_1 \concat k_2 \concat c_2 \concat \pk_2}

\newcommand{\odh}{\textsf{DH}\xspace}

\newcommand{\nominalgroup}{\mathcal{N}}
\newcommand{\nominalgroupexpanded}{(\nelem, \ngen, p, \honestexponent , \exponent , \nexp)}
\newcommand{\honestexponent}{\varepsilon_h}
\newcommand{\exponent}{\varepsilon_u}
\newcommand{\nexp}{\textsf{exp}\xspace}
\newcommand{\nelem}{\mathcal{G}}
\newcommand{\ngen}{g}
\newcommand{\prfqueries}{q_e}
\newcommand{\ngalg}{\mathsf{NG}}


\newcommand{\encode}{\textsf{encode\_pk}\xspace}
\newcommand{\decode}{\textsf{decode\_pk}\xspace}

\newcommand{\oracledec}{\oracle $\dec(c)$}
\newcommand{\simoracledec}{\textbf{Simulated oracle} $\dec(c)$}
\newcommand{\oraclerom}[2]{$H_{#1}(#2)$}

% colours for game hops
\definecolor{one}{RGB}{255,0,0}
\definecolor{two}{RGB}{0,100,0}
\definecolor{three}{RGB}{0,0,255}
\definecolor{four}{RGB}{255,180,0}
\definecolor{five}{RGB}{255,0,255}
\definecolor{six}{RGB}{0,255,0}

\newcommand{\gzero}{zero}
\newcommand{\gone}{one}
\newcommand{\gtwo}{two}
\newcommand{\gthree}{three}
\newcommand{\gfour}{four}
\newcommand{\gfive}{five}
\newcommand{\gsix}{six}

\newcommand{\sha}{\text{SHA3-256}\xspace}
\newcommand{\prf}{\text{PRF}\xspace}
\newcommand{\G}[2]{G_{#1}^{#2}\xspace}

\renewcommand\thealgorithm{}
\newcommand{\setalglineno}[1]{%
  \setcounter{ALG@line}{\numexpr#1-1}}

\newcommand{\mathactivatecomma}{%
  \begingroup\lccode`~=`\,
  \lowercase{\endgroup\edef~}{\mathchar\the\mathcode`\,\penalty0 }}

\newcommand{\storeandloadcaption}{}
\newcommand{\storeandloadlabel}{}

\newenvironment{gamefigure}[2]{
  \gdef\storeandloadcaption{#1}
  \gdef\storeandloadlabel{#2}
  \begin{figure}[ht!]
    \hrule
    \vspace{1mm}
    }{
    \hrule
    \caption{\storeandloadcaption} \label{\storeandloadlabel}
  \end{figure}
}

\newenvironment{xwingfigure}[2]{
  \gdef\storeandloadcaption{#1}
  \gdef\storeandloadlabel{#2}
  \begin{figure}[H]
    \hrule
    % \vspace{1mm}
    }{
    \hrule
    \caption{\storeandloadcaption} \label{\storeandloadlabel}
  \end{figure}
}

\newcommand{\defaultcolumnsize}{2}

\newenvironment{games}[1]{
  \begin{multicols}{#1}
    }{
  \end{multicols}
}

\newenvironment{gameenv}[1]{
  \begin{algorithmic}
    \Statex \underline{#1}
    % \vspace{1mm}
    }{
  \end{algorithmic}
}

\newcommand{\gamebreak}{\columnbreak}

\newcommand{\emptygame}{
  \begin{gameenv}{\null}
  \end{gameenv}
}
